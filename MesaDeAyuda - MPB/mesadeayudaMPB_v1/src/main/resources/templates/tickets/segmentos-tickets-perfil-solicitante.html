<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:th="http://www.thymeleaf.org">
    <head th:replace="~{layout/plantilla :: head}">
        <title>Mesa de Ayuda</title>
        <meta charset="UTF-8"/>
    </head>

    <body>
        <!-- Sección de Perfil -->
        <section th:fragment="perfil-section">
            <div class="header-container">
                <a href="javascript:void(0);" onclick="window.history.back();" class="btn btn-outline-secondary back-button">
                    <i class="fa-solid fa-arrow-left"></i>
                </a>
                <h2 id="Title" style="margin: initial;">Perfil del Solicitante</h2>
            </div>
            <div class="profile-card">
                <div class="profile-header">
                    <div class="image-upload-container">
                        <label>
                            <img th:src="@{/usuario/imagen/{id}(id=${usuario.idUsuario})}" alt="Imagen de perfil">
                        </label>
                        <input type="file" id="imagenFile" name="imagenFile" accept="image/*" style="display: none" onchange="previewImage(this)">
                    </div>
                    <div class="profile-info">
                        <div id="infoUsuario">
                            <h3 style="display: inline;" th:text="${usuario.nombre + ' ' + usuario.apellido}"></h3>
                            <p style="display: inline;" th:text="'ID#' + ${usuario.codigo}"></p>
                        </div>
                        <p id="infoUsuario"><b>Departamento:</b> <span th:text="${usuario.departamento}"></span></p>
                        <p id="infoUsuario">
                            <b>Último Acceso al Sistema:</b>
                            <span th:if="${ultimaConexion != null}" th:text="${#temporals.format(ultimaConexion, 'EEEE, d ''de'' MMMM ''de'' yyyy', new java.util.Locale('es', 'ES'))}"></span>
                            <span th:unless="${ultimaConexion != null}">Sin información</span>
                        </p>
                    </div>
                </div>
                <div class="profile-details">
                    <div class="detail-row">
                        <div class="detail-column">
                            <label>Provincia</label>
                            <input type="text" th:value="${usuario.provincia}" placeholder="Sin Informacion..." readonly>
                        </div>
                        <div class="detail-column">
                            <label>Dirección</label>
                            <textarea class="form-control" style="height: 140%;" readonly th:text="${usuario.direccion}" placeholder="Sin Informacion..."></textarea>
                        </div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-column" id="columnaTelefono">
                            <label>Número de Teléfono</label>
                            <input type="text" id="inputTelefono" th:if="${usuario.numeroTelefono != null and usuario.numeroTelefono != ''}" th:value="${'+506 ' + usuario.numeroTelefono}" readonly>
                                <input type="text" id="inputTelefono" th:unless="${usuario.numeroTelefono != null and usuario.numeroTelefono != ''}" value="Sin Información..." readonly>
                                    </div>
                                    </div>
                                    <div class="detail-row" style="margin-bottom: 0rem;">
                                        <div class="detail-column">
                                            <label>Ocupación o Departamento</label>
                                            <input type="text" th:value="${usuario.departamento}" placeholder="Sin Informacion..." readonly>
                                        </div>
                                        <div class="detail-column">
                                            <label>Correo Electrónico</label>
                                            <input type="text" th:value="${usuario.correoElectronico}" placeholder="Sin Informacion..." readonly>
                                        </div>
                                    </div>
                                    </div>
                                    </div>
                                    </section>

                                    <!-- Sección de Tickets -->
                                    <section th:fragment="tickets-section">
                                        <h2 class="h4 mb-3">Tickets Recientes</h2>
                                        <div class="row g-4">
                                            <div class="col-12">
                                                <div class="card card-ticket status-abierto">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <span class="text-muted small">#TIC001</span>
                                                            <span class="badge bg-warning text-dark badge-status">Abierto</span>
                                                        </div>
                                                        <h3 class="h5 mb-2">Problema con el sistema de Facturación</h3>
                                                        <div class="text-muted small">
                                                            <p class="mb-1">Prioridad: Baja</p>
                                                            <p class="mb-1">Categoría: Hardware</p>
                                                            <p class="mb-0">Fecha: 23-08-2024</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="card card-ticket status-en-progreso">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <span class="text-muted small">#TIC002</span>
                                                            <span class="badge bg-primary badge-status">En progreso</span>
                                                        </div>
                                                        <h3 class="h5 mb-2">Actualización de software requerida</h3>
                                                        <div class="text-muted small">
                                                            <p class="mb-1">Prioridad: Media</p>
                                                            <p class="mb-1">Categoría: Software</p>
                                                            <p class="mb-0">Fecha: 22-08-2024</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="card card-ticket status-completado">
                                                    <div class="card-body">
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <span class="text-muted small">#TIC003</span>
                                                            <span class="badge bg-success badge-status">Completado</span>
                                                        </div>
                                                        <h3 class="h5 mb-2">Solicitud de nuevo equipo</h3>
                                                        <div class="text-muted small">
                                                            <p class="mb-1">Prioridad: Alta</p>
                                                            <p class="mb-1">Categoría: Hardware</p>
                                                            <p class="mb-0">Fecha: 21-08-2024</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </section>
                                    </body>
                                    </html>